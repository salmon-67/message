<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Salmon | Premium Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-app: #0b0c0d;
            --bg-side: #111214;
            --bg-chat: #1c1d21;
            --bg-input: #2b2d31;
            --accent: #007aff;
            --success: #23a55a;
            --danger: #da373c;
            --text-main: #f5f5f7;
            --text-dim: #949ba4;
            --border: rgba(255, 255, 255, 0.06);
            --radius: 12px;
        }

        * { box-sizing: border-box; -webkit-font-smoothing: antialiased; font-family: 'Inter', sans-serif; }
        body { margin: 0; background: var(--bg-app); color: var(--text-main); height: 100dvh; display: flex; overflow: hidden; }

        /* Auth/Admin Modals */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 2000; display: flex; align-items: center; justify-content: center; }
        .modal-card { width: 90%; max-width: 400px; background: var(--bg-side); padding: 32px; border-radius: 24px; border: 1px solid var(--border); text-align: center; }

        /* Main Layout Fixes */
        #app-container { display: none; width: 100%; height: 100%; flex-direction: row; }
        
        #sidebar-left { width: 260px; min-width: 260px; background: var(--bg-side); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        
        #main-chat { flex: 1; background: var(--bg-chat); display: flex; flex-direction: column; min-width: 0; }
        
        #sidebar-right { width: 240px; min-width: 240px; background: var(--bg-side); border-left: 1px solid var(--border); display: none; flex-direction: column; }

        /* Header Fixes */
        .header-bar { height: 56px; padding: 0 16px; display: flex; align-items: center; border-bottom: 1px solid var(--border); gap: 12px; background: var(--bg-side); }
        .header-btn { background: none; border: none; color: var(--text-dim); font-size: 20px; cursor: pointer; padding: 4px; display: flex; align-items: center; }
        .header-btn:hover { color: var(--text-main); }

        /* Message Area Fixes */
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: none; flex-direction: column; gap: 16px; }
        .msg-group { display: flex; flex-direction: column; align-items: flex-start; max-width: 80%; }
        .msg-sender { font-size: 13px; font-weight: 600; color: var(--accent); margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
        .msg-bubble { background: var(--bg-input); padding: 10px 14px; border-radius: 16px; border-top-left-radius: 4px; color: var(--text-main); line-height: 1.4; font-size: 15px; }
        
        .verified-badge { width: 16px; height: 16px; display: inline-block; vertical-align: middle; }

        /* UI Elements */
        .channel-item { padding: 10px 12px; margin: 2px 8px; border-radius: 8px; cursor: pointer; color: var(--text-dim); font-weight: 500; font-size: 14px; }
        .channel-item.active { background: var(--accent); color: white; }
        .channel-item:hover:not(.active) { background: rgba(255,255,255,0.05); }

        .auth-input { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 10px; background: var(--bg-input); border: 1px solid var(--border); color: white; outline: none; }
        .btn-action { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: 700; cursor: pointer; }

        /* Input Bar */
        #input-area { padding: 16px 20px; background: var(--bg-chat); }
        .input-wrapper { background: var(--bg-input); border-radius: 20px; padding: 6px 12px; display: flex; align-items: center; gap: 10px; border: 1px solid var(--border); }
        #msg-input { flex: 1; background: none; border: none; color: white; padding: 8px 0; outline: none; font-size: 15px; resize: none; max-height: 120px; }
        
        .send-circle { width: 32px; height: 32px; background: var(--accent); border-radius: 50%; border: none; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
    </style>
</head>
<body>

    <div id="admin-dashboard" class="modal-overlay" style="display:none;">
        <div class="modal-card">
            <h2 style="margin-top:0">Admin Console</h2>
            <div id="admin-user-list" style="max-height: 300px; overflow-y: auto; text-align: left; margin-bottom: 20px;"></div>
            <button onclick="document.getElementById('admin-dashboard').style.display='none'" class="btn-action" style="background:var(--accent); color:white;">Close</button>
        </div>
    </div>

    <div id="auth-container" class="modal-overlay">
        <div class="modal-card">
            <h1 style="color:var(--accent); margin:0 0 8px;">Salmon</h1>
            <p style="color:var(--text-dim); font-size:14px; margin-bottom:24px;">Dive into the stream.</p>
            <input type="text" id="username" class="auth-input" placeholder="Username">
            <input type="password" id="password" class="auth-input" placeholder="Password">
            <button id="btn-login" class="btn-action" style="background:var(--accent); color:white; margin-bottom:12px;">Sign In</button>
            <button id="btn-signup" style="background:none; border:none; color:var(--accent); font-weight:600; cursor:pointer;">Create Account</button>
        </div>
    </div>

    <div id="app-container">
        <nav id="sidebar-left">
            <div class="header-bar"><span style="font-weight:900; color:var(--accent); letter-spacing:1px;">SALMON</span></div>
            <div id="chat-list" style="flex:1; overflow-y:auto; padding-top:10px;"></div>
            
            <div style="padding:16px; border-top:1px solid var(--border);">
                <button id="btn-open-admin" style="display:none; width:100%; background:none; border:1px solid var(--accent); color:var(--accent); padding:8px; border-radius:8px; margin-bottom:12px; cursor:pointer; font-weight:600; font-size:12px;">Admin Panel</button>
                <input type="text" id="group-name" class="auth-input" placeholder="Channel Name" style="font-size:13px;">
                <button id="btn-create-channel" class="btn-action" style="background:var(--success); color:white; padding:10px; font-size:13px;">+ New Channel</button>
            </div>

            <div style="padding:12px; background: rgba(0,0,0,0.2); display:flex; align-items:center; gap:10px;">
                <div id="user-badge" style="width:32px; height:32px; background:var(--accent); border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold;">U</div>
                <div id="user-display-name" style="flex:1; font-size:13px; font-weight:600; overflow:hidden;">User</div>
                <button id="btn-logout" style="background:none; border:none; color:var(--danger); font-size:11px; font-weight:800; cursor:pointer;">OUT</button>
            </div>
        </nav>

        <main id="main-chat">
            <header class="header-bar">
                <span id="chat-title" style="flex:1; font-weight:700;">Select a Channel</span>
                <button id="btn-toggle-members" class="header-btn">üë•</button>
            </header>

            <div id="welcome-view" style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; opacity:0.2;">
                <div style="font-size:80px;">üêü</div>
                <p>Welcome to Salmon</p>
            </div>

            <div id="messages"></div>
            <div id="typing-box" style="font-size:11px; color:var(--text-dim); padding: 4px 20px; height:20px;"></div>

            <div id="input-area" style="display:none;">
                <div class="input-wrapper">
                    <textarea id="msg-input" placeholder="Message..." rows="1"></textarea>
                    <button id="btn-send" class="send-circle">‚ûî</button>
                </div>
            </div>
        </main>

        <aside id="sidebar-right">
            <div class="header-bar"><span style="font-size:12px; font-weight:800; color:var(--text-dim)">MEMBERS</span></div>
            <div id="member-list" style="flex:1; overflow-y:auto;"></div>
        </aside>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>
